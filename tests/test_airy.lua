local gsl = require("lgsl.gsl")
local sf= require("lgsl.sf")
local GSL_DBL_EPSILON, GSL_SQRT_DBL_EPSILON, GSL_LOG_DBL_MAX = 2.2204460492503131e-16, 1.4901161193847656e-08, 7.0978271289338397e+02
local function sprintf(...) io.write(string.format(...)) end
local sqrt, log, exp, M_PI, M_PI_2, DBL_MAX = math.sqrt, math.log, math.exp, math.pi, math.pi/2, 1.7976931348623157E+308
local function compare(val, ref, name, eps)
  eps = eps or 1e-9
  local inc = 0
  if val==0 or ref==0 then inc = 1 end
  if gsl.gsl_fcmp(val+inc,ref+inc,eps*100)==0 then
    sprintf("Pass %-30s: % .15e\n", name, ref,"\n")
  else
    sprintf("Fail %-30s: % .15e ~= % .15e\n", name, val, ref)
  end
end
local TEST_TOL0 = (2.0*GSL_DBL_EPSILON)
local TEST_TOL1 = (16.0*GSL_DBL_EPSILON)
local TEST_TOL2 = (256.0*GSL_DBL_EPSILON)
local TEST_TOL3 = (2048.0*GSL_DBL_EPSILON)
local TEST_TOL4 = (16384.0*GSL_DBL_EPSILON)
local TEST_TOL5 = (131072.0*GSL_DBL_EPSILON)
local TEST_TOL6 = (1048576.0*GSL_DBL_EPSILON)
compare(sf.airyAi(-500.0)                ,      0.0725901201040411396, "airyAi(-500.0)", TEST_TOL4)
compare(sf.airyAi(-5.0)                  ,         0.3507610090241142, "airyAi(-5.0)", TEST_TOL0)
compare(sf.airyAi(-0.3000000000000094)   ,         0.4309030952855831, "airyAi(-0.3000000000000094)", TEST_TOL0)
compare(sf.airyAi(0.6999999999999907)    ,         0.1891624003981519, "airyAi(0.6999999999999907)", TEST_TOL0)
compare(sf.airyAi(1.649999999999991)     ,      0.0583105861872088521, "airyAi(1.649999999999991)", TEST_TOL0)
compare(sf.airyAi(2.54999999999999)      ,        0.01446149513295428, "airyAi(2.54999999999999)", TEST_TOL0)
compare(sf.airyAi(3.499999999999987)     ,       0.002584098786989702, "airyAi(3.499999999999987)", TEST_TOL1)
compare(sf.airyAi(5.39999999999998)      ,      4.272986169411866e-05, "airyAi(5.39999999999998)", TEST_TOL0)
compare(sf.airyAi_scaled(-5.0)           ,         0.3507610090241142, "airyAi_scaled(-5.0)", TEST_TOL0)
compare(sf.airyAi_scaled(0.6999999999999907),         0.2795125667681217, "airyAi_scaled(0.6999999999999907)", TEST_TOL0)
compare(sf.airyAi_scaled(1.649999999999991),         0.2395493001442741, "airyAi_scaled(1.649999999999991)", TEST_TOL0)
compare(sf.airyAi_scaled(2.54999999999999),         0.2183658595899388, "airyAi_scaled(2.54999999999999)", TEST_TOL0)
compare(sf.airyAi_scaled(3.499999999999987),         0.2032920808163519, "airyAi_scaled(3.499999999999987)", TEST_TOL0)
compare(sf.airyAi_scaled(5.39999999999998),         0.1836050093282229, "airyAi_scaled(5.39999999999998)", TEST_TOL0)
compare(sf.airyBi(-500.0)                ,      -0.094688570132991028, "airyBi(-500.0)", TEST_TOL4)
compare(sf.airyBi(-5.0)                  ,        -0.1383691349016005, "airyBi(-5.0)", TEST_TOL1)
compare(sf.airyBi(0.6999999999999907)    ,         0.9733286558781599, "airyBi(0.6999999999999907)", TEST_TOL0)
compare(sf.airyBi(1.649999999999991)     ,          2.196407956850028, "airyBi(1.649999999999991)", TEST_TOL0)
compare(sf.airyBi(2.54999999999999)      ,          6.973628612493443, "airyBi(2.54999999999999)", TEST_TOL0)
compare(sf.airyBi(3.499999999999987)     ,          33.05550675461069, "airyBi(3.499999999999987)", TEST_TOL1)
compare(sf.airyBi(5.39999999999998)      ,          1604.476078241272, "airyBi(5.39999999999998)", TEST_TOL1)
compare(sf.airyBi_scaled(-5.0)           ,        -0.1383691349016005, "airyBi_scaled(-5.0)", TEST_TOL1)
compare(sf.airyBi_scaled(0.6999999999999907),         0.6587080754582302, "airyBi_scaled(0.6999999999999907)", TEST_TOL0)
compare(sf.airyBi_scaled(1.649999999999991),         0.5346449995597539, "airyBi_scaled(1.649999999999991)", TEST_TOL0)
compare(sf.airyBi_scaled(2.54999999999999),          0.461835455542297, "airyBi_scaled(2.54999999999999)", TEST_TOL0)
compare(sf.airyBi_scaled(3.499999999999987),         0.4201771882353061, "airyBi_scaled(3.499999999999987)", TEST_TOL1)
compare(sf.airyBi_scaled(5.39999999999998),         0.3734050675720473, "airyBi_scaled(5.39999999999998)", TEST_TOL0)
compare(sf.airyAi_deriv(-5.0)            ,         0.3271928185544435, "airyAi_deriv(-5.0)", TEST_TOL1)
compare(sf.airyAi_deriv(-0.5500000000000094),        -0.1914604987143629, "airyAi_deriv(-0.5500000000000094)", TEST_TOL0)
compare(sf.airyAi_deriv(0.4999999999999906),        -0.2249105326646850, "airyAi_deriv(0.4999999999999906)", TEST_TOL0)
compare(sf.airyAi_deriv(1.899999999999992),       -0.06043678178575718, "airyAi_deriv(1.899999999999992)", TEST_TOL0)
compare(sf.airyAi_deriv(3.249999999999988),      -0.007792687926790889, "airyAi_deriv(3.249999999999988)", TEST_TOL0)
compare(sf.airyAi_deriv(5.199999999999981),     -0.0001589434526459543, "airyAi_deriv(5.199999999999981)", TEST_TOL1)
compare(sf.airyAi_deriv_scaled(-5.0)     ,         0.3271928185544435, "airyAi_deriv_scaled(-5.0)", TEST_TOL1)
compare(sf.airyAi_deriv_scaled(0.5499999999999906),        -0.2874057279170166, "airyAi_deriv_scaled(0.5499999999999906)", TEST_TOL0)
compare(sf.airyAi_deriv_scaled(1.499999999999991),        -0.3314199796863637, "airyAi_deriv_scaled(1.499999999999991)", TEST_TOL0)
compare(sf.airyAi_deriv_scaled(2.49999999999999),        -0.3661089384751620, "airyAi_deriv_scaled(2.49999999999999)", TEST_TOL0)
compare(sf.airyAi_deriv_scaled(3.649999999999986),        -0.3974033831453963, "airyAi_deriv_scaled(3.649999999999986)", TEST_TOL0)
compare(sf.airyAi_deriv_scaled(6.299999999999977),        -0.4508799189585947, "airyAi_deriv_scaled(6.299999999999977)", TEST_TOL0)
compare(sf.airyBi_deriv(-5.0)            ,          0.778411773001899, "airyBi_deriv(-5.0)", TEST_TOL0)
compare(sf.airyBi_deriv(-0.5500000000000094),         0.5155785358765014, "airyBi_deriv(-0.5500000000000094)", TEST_TOL0)
compare(sf.airyBi_deriv(0.4999999999999906),         0.5445725641405883, "airyBi_deriv(0.4999999999999906)", TEST_TOL0)
compare(sf.airyBi_deriv(1.899999999999992),          3.495165862891568, "airyBi_deriv(1.899999999999992)", TEST_TOL0)
compare(sf.airyBi_deriv(3.249999999999988),          36.55485149250338, "airyBi_deriv(3.249999999999988)", TEST_TOL0)
compare(sf.airyBi_deriv(5.199999999999981),          2279.748293583233, "airyBi_deriv(5.199999999999981)", TEST_TOL1)
compare(sf.airyBi_deriv_scaled(-5.0)     ,          0.778411773001899, "airyBi_deriv_scaled(-5.0)", TEST_TOL0)
compare(sf.airyBi_deriv_scaled(0.5499999999999906),         0.4322811281817566, "airyBi_deriv_scaled(0.5499999999999906)", TEST_TOL0)
compare(sf.airyBi_deriv_scaled(1.499999999999991),         0.5542307563918037, "airyBi_deriv_scaled(1.499999999999991)", TEST_TOL0)
compare(sf.airyBi_deriv_scaled(2.49999999999999),         0.6755384441644985, "airyBi_deriv_scaled(2.49999999999999)", TEST_TOL0)
compare(sf.airyBi_deriv_scaled(3.649999999999986),         0.7613959373000228, "airyBi_deriv_scaled(3.649999999999986)", TEST_TOL0)
compare(sf.airyBi_deriv_scaled(6.299999999999977),         0.8852064139737571, "airyBi_deriv_scaled(6.299999999999977)", TEST_TOL0)
compare(sf.airyAi_zero(2)                ,      -4.087949444130970617, "airyAi_zero(2)", TEST_TOL0)
compare(sf.airyAi_zero(50)               ,      -38.02100867725525443, "airyAi_zero(50)", TEST_TOL0)
compare(sf.airyAi_zero(100)              ,      -60.45555727411669871, "airyAi_zero(100)", TEST_TOL0)
compare(sf.airyAi_zero(110)              ,      -64.43135670991324811, "airyAi_zero(110)", TEST_TOL0)
compare(sf.airyBi_zero(2)                ,      -3.271093302836352716, "airyBi_zero(2)", TEST_TOL0)
compare(sf.airyBi_zero(50)               ,      -37.76583438165180116, "airyBi_zero(50)", TEST_TOL0)
compare(sf.airyBi_zero(100)              ,      -60.25336482580837088, "airyBi_zero(100)", TEST_TOL0)
compare(sf.airyBi_zero(110)              ,       -64.2355167606561537, "airyBi_zero(110)", TEST_TOL0)
compare(sf.airyBi_zero(111)              ,       -64.6268994819519378, "airyBi_zero(111)", TEST_TOL0)
compare(sf.airyBi_zero(200)              ,      -95.88699147356682665, "airyBi_zero(200)", TEST_TOL0)
compare(sf.airyAi_deriv_zero(2)          ,      -3.248197582179836561, "airyAi_deriv_zero(2)", TEST_TOL0)
compare(sf.airyAi_deriv_zero(50)         ,      -37.76565910053887108, "airyAi_deriv_zero(50)", TEST_TOL0)
compare(sf.airyAi_deriv_zero(100)        ,      -60.25329596442479317, "airyAi_deriv_zero(100)", TEST_TOL0)
compare(sf.airyAi_deriv_zero(110)        ,      -64.23545617243546956, "airyAi_deriv_zero(110)", TEST_TOL0)
compare(sf.airyAi_deriv_zero(1000)       ,      -280.9378080358935071, "airyAi_deriv_zero(1000)", TEST_TOL0)
compare(sf.airyBi_deriv_zero(2)          ,      -4.073155089071828216, "airyBi_deriv_zero(2)", TEST_TOL0)
compare(sf.airyBi_deriv_zero(50)         ,      -38.02083574095788210, "airyBi_deriv_zero(50)", TEST_TOL0)
compare(sf.airyBi_deriv_zero(100)        ,      -60.45548887257140819, "airyBi_deriv_zero(100)", TEST_TOL0)
compare(sf.airyBi_deriv_zero(110)        ,      -64.43129648944845060, "airyBi_deriv_zero(110)", TEST_TOL0)
compare(sf.airyBi_deriv_zero(111)        ,      -64.82208737584206093, "airyBi_deriv_zero(111)", TEST_TOL0)
compare(sf.airyBi_deriv_zero(200)        ,      -96.04731050310324450, "airyBi_deriv_zero(200)", TEST_TOL0)
compare(sf.airyBi_deriv_zero(1000)       ,      -281.0315164471118527, "airyBi_deriv_zero(1000)", TEST_TOL0)
