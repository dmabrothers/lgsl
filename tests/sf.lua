-- This is a (generated) test script for all the methods in the special functions module.

local sf = require("lgsl.sf")
local complex = require("lgsl.complex")
local gsl = require("lgsl.gsl")
local sprintf = function(...) return io.write(string.format(...)) end
local sqrt = math.sqrt
local eps = 1e-12

local function compare(val, ref, name)
  local inc = 0
  if val==0 or ref==0 then inc = 1 end
  if gsl.gsl_fcmp(val+inc,ref+inc,eps)==0 then
    sprintf("Pass %-30s: % .15e\n", name, ref,"\n")
  else
    sprintf("Fail %-30s: % .15e ~= % .15e\n", name, val, ref)
  end
end

compare(sf.Chi(1)                        ,  8.378669409802082e-01, "Chi(1)")
compare(sf.Ci(1)                         ,  3.374039229009682e-01, "Ci(1)")
compare(sf.Shi(1)                        ,  1.057250875375728e+00, "Shi(1)")
compare(sf.Si(1)                         ,  9.460830703671830e-01, "Si(1)")
compare(sf.airyAi(1)                     ,  1.352924163128814e-01, "airyAi(1)")
compare(sf.airyAi_deriv(1)               , -1.591474412967932e-01, "airyAi_deriv(1)")
compare(sf.airyAi_deriv_scaled(1)        , -3.099768889605148e-01, "airyAi_deriv_scaled(1)")
compare(sf.airyAi_scaled(1)              ,  2.635136447491401e-01, "airyAi_scaled(1)")
compare(sf.airyAi_zero(1)                , -2.338107410459767e+00, "airyAi_zero(1)")
compare(sf.airyAi_deriv_zero(1)          , -1.018792971647471e+00, "airyAi_deriv_zero(1)")
compare(sf.airyBi(1)                     ,  1.207423594952871e+00, "airyBi(1)")
compare(sf.airyBi_deriv(1)               ,  9.324359333927756e-01, "airyBi_deriv(1)")
compare(sf.airyBi_deriv_scaled(1)        ,  4.787285706049847e-01, "airyBi_deriv_scaled(1)")
compare(sf.airyBi_scaled(1)              ,  6.199119435726785e-01, "airyBi_scaled(1)")
compare(sf.airyBi_zero(1)                , -1.173713222709128e+00, "airyBi_zero(1)")
compare(sf.airyBi_deriv_zero(1)          , -2.294439682614123e+00, "airyBi_deriv_zero(1)")
compare(sf.atanint(1)                    ,  9.159655941772190e-01, "atanint(1)")
compare(sf.besselI(1,1)                  ,  5.651591039924850e-01, "besselI(1,1)")
compare(sf.besselI_scaled(1,1)           ,  2.079104153497085e-01, "besselI_scaled(1,1)")
compare(sf.besselInu(1,1)                ,  5.651591039924850e-01, "besselInu(1,1)")
compare(sf.besselInu_scaled(1,1)         ,  2.079104153497085e-01, "besselInu_scaled(1,1)")
compare(sf.besselJ(1,1)                  ,  4.400505857449335e-01, "besselJ(1,1)")
compare(sf.besselJnu(1,1)                ,  4.400505857449336e-01, "besselJnu(1,1)")
compare(sf.besselJ_zero(1,1)             ,  3.831705970207513e+00, "besselJ_zero(1,1)")
compare(sf.besselK(1,1)                  ,  6.019072301972346e-01, "besselK(1,1)")
compare(sf.besselK_scaled(1,1)           ,  1.636153486263258e+00, "besselK_scaled(1,1)")
compare(sf.besselKnu(1,1)                ,  6.019072301972346e-01, "besselKnu(1,1)")
compare(sf.besselKnu_scaled(1,1)         ,  1.636153486263258e+00, "besselKnu_scaled(1,1)")
compare(sf.besselY(1,1)                  , -7.812128213002888e-01, "besselY(1,1)")
compare(sf.besselYnu(1,1)                , -7.812128213002889e-01, "besselYnu(1,1)")
compare(sf.besseli_scaled(1,1)           ,  1.353352832366128e-01, "besseli_scaled(1,1)")
compare(sf.besselj(1,1)                  ,  3.011686789397567e-01, "besselj(1,1)")
compare(sf.besselk_scaled(1,1)           ,  3.141592653589793e+00, "besselk_scaled(1,1)")
compare(sf.bessellnKnu(1,1)              , -5.076519482107524e-01, "bessellnKnu(1,1)")
compare(sf.bessely(1,1)                  , -1.381773290676036e+00, "bessely(1,1)")
compare(sf.beta(1,1)                     ,  1.000000000000000e+00, "beta(1,1)")
compare(sf.beta_inc(1,1,1)               ,  1.000000000000000e+00, "beta_inc(1,1,1)")
compare(sf.choose(1,1)                   ,  1.000000000000000e+00, "choose(1,1)")
compare(sf.doublefact(1)                 ,  1.000000000000000e+00, "doublefact(1)")
compare(sf.fact(1)                       ,  1.000000000000000e+00, "fact(1)")
compare(sf.clausen(1)                    ,  1.013959132360768e+00, "clausen(1)")
compare(sf.conicalP(1,1,1)               ,  0.000000000000000e+00, "conicalP(1,1,1)")
compare(sf.conicalPcylreg(1,1,1)         ,  0.000000000000000e+00, "conicalPcylreg(1,1,1)")
compare(sf.conicalPsphreg(1,1,1)         ,  0.000000000000000e+00, "conicalPsphreg(1,1,1)")
compare(sf.coulomb_CL(1,1)               ,  5.111086283184188e-02, "coulomb_CL(1,1)")
compare(sf.coupling_3j(2,3,3,0,1,-1)     , -1.290994448735810e-01, "coupling_3j(2,3,3,0,1,-1)")
compare(sf.coupling_6j(1,1,1,1,1,1)      ,  0.000000000000000e+00, "coupling_6j(1,1,1,1,1,1)")
compare(sf.coupling_6j(2,2,2,2,2,2)      ,  1.666666666666670e-01, "coupling_6j(2,2,2,2,2,2)")
compare(sf.coupling_9j(1,1,1,1,1,1,1,1,1),  0.000000000000000e+00, "coupling_9j(1,1,1,1,1,1,1,1,1)")
compare(sf.coupling_9j(6,8,2,6,6,6,4,6,8), -5.953880481553000e-03, "coupling_9j(6,8,2,6,6,6,4,6,8)")
compare(sf.dawson(1)                     ,  5.380795069127684e-01, "dawson(1)")
compare(sf.debye(1,1)                    ,  7.775046341122482e-01, "debye(1,1)")
compare(sf.dilog(1)                      ,  1.644934066848226e+00, "dilog(1)")
compare(complex.real(sf.cdilog(1+1i))    ,  6.168502750680850e-01, "Re(cdilog(1+1i))")
compare(complex.imag(sf.cdilog(1+1i))    ,  1.460362116753119e+00, "Im(cdilog(1+1i))")
compare(sf.ellint_D(1,1,1)               ,  3.847201860756206e-01, "ellint_D(1,1,1)")
compare(sf.ellint_E(1,1)                 ,  8.414709848078964e-01, "ellint_E(1,1)")
compare(sf.ellint_F(1,1)                 ,  1.226191170883517e+00, "ellint_F(1,1)")
compare(sf.ellint_P(1,1,1)               ,  9.628564076160182e-01, "ellint_P(1,1,1)")
compare(sf.ellint_RC(1,1)                ,  1.000000000000000e+00, "ellint_RC(1,1)")
compare(sf.ellint_RD(1,1,1)              ,  1.000000000000000e+00, "ellint_RD(1,1,1)")
compare(sf.ellint_RF(1,1,1)              ,  1.000000000000000e+00, "ellint_RF(1,1,1)")
compare(sf.ellint_RJ(1,1,1,1)            ,  1.000000000000000e+00, "ellint_RJ(1,1,1,1)")
compare(sf.erf(1)                        ,  8.427007929497149e-01, "erf(1)")
compare(sf.erf_Q(1)                      ,  1.586552539314571e-01, "erf_Q(1)")
compare(sf.erf_Z(1)                      ,  2.419707245191433e-01, "erf_Z(1)")
compare(sf.erfc(1)                       ,  1.572992070502851e-01, "erfc(1)")
compare(sf.log_erfc(1)                   , -1.849605509933248e+00, "log_erfc(1)")
compare(sf.eta(1)                        ,  6.931471805599453e-01, "eta(1)")
compare(sf.exp(1)                        ,  2.718281828459045e+00, "exp(1)")
compare(sf.exp_err(1,1)                 ,  2.718281828459045e+00, "exp_err(1,1)")
compare(sf.exp_mult(1,1)                 ,  2.718281828459045e+00, "exp_mult(1,1)")
compare(sf.exp_mult_err(1,1,1,1)         ,  2.718281828459045e+00, "exp_mult_err(1,1,1,1)")
compare(sf.expint3(1)                    ,  8.075111821396715e-01, "expint3(1)")
compare(sf.expint_Ei(1)                  ,  1.895117816355937e+00, "expint_Ei(1)")
compare(sf.expint_E(1,1)                 ,  2.193839343955203e-01, "expint_E(1,1)")
compare(sf.expm1(1)                      ,  1.718281828459045e+00, "expm1(1)")
compare(sf.exprel(1)                     ,  1.718281828459045e+00, "exprel(1)")
compare(sf.exprel_2(1)                   ,  1.436563656918090e+00, "exprel_2(1)")
compare(sf.exprel_n(1,1)                 ,  1.718281828459045e+00, "exprel_n(1,1)")
compare(sf.fermi_dirac(1,1)              ,  1.806286070444775e+00, "fermi_dirac(1,1)")
compare(sf.fermi_dirac_inc(1,1)          ,  6.931471805599453e-01, "fermi_dirac_inc(1,1)")
compare(sf.gamma(1)                      ,  1.000000000000000e+00, "gamma(1)")
compare(sf.gamma_inc(1,1)                ,  3.678794411714423e-01, "gamma_inc(1,1)")
compare(sf.gamma_inc_P(1,1)              ,  6.321205588285578e-01, "gamma_inc_P(1,1)")
compare(sf.gamma_inc_Q(1,1)              ,  3.678794411714423e-01, "gamma_inc_Q(1,1)")
compare(sf.gammainv(1)                   ,  1.000000000000000e+00, "gammainv(1)")
compare(sf.gammastar(1)                  ,  1.084437551419227e+00, "gammastar(1)")
compare(sf.hyperg0F1(1,1)                ,  2.279585302336067e+00, "hyperg0F1(1,1)")
compare(sf.hyperg1F1(1,1,1)              ,  2.718281828459045e+00, "hyperg1F1(1,1,1)")
compare(sf.hypergU(1,1,1)                ,  5.963473623231944e-01, "hypergU(1,1,1)")
compare(sf.laguerre(1,1,1)               ,  1.000000000000000e+00, "laguerre(1,1,1)")
compare(sf.lambertW0(1)                  ,  5.671432904097838e-01, "lambertW0(1)")
compare(sf.lambertWm1(1)                 ,  5.671432904097838e-01, "lambertWm1(1)")
compare(sf.legendreH3d(1,1,1)            ,  3.397013994799346e-01, "legendreH3d(1,1,1)")
compare(sf.legendreP(1,1)                ,  1.000000000000000e+00, "legendreP(1,1)")
compare(sf.legendrePlm(1,1,1)            , -0.000000000000000e+00, "legendrePlm(1,1,1)")
compare(sf.legendresphPlm(1,1,1)         ,  0.000000000000000e+00, "legendresphPlm(1,1,1)")
compare(sf.lnbeta(1,1)                   , -0.000000000000000e+00, "lnbeta(1,1)")
compare(sf.lnchoose(1,1)                 ,  0.000000000000000e+00, "lnchoose(1,1)")
compare(sf.lndoublefact(1)               ,  0.000000000000000e+00, "lndoublefact(1)")
compare(sf.lnfact(1)                     ,  0.000000000000000e+00, "lnfact(1)")
compare(sf.lngamma(1)                    , -0.000000000000000e+00, "lngamma(1)")
compare(sf.lnpoch(1,1)                   , -0.000000000000000e+00, "lnpoch(1,1)")
compare(sf.log(1)                        ,  0.000000000000000e+00, "log(1)")
compare(sf.log_1plusx(1)                 ,  6.931471805599453e-01, "log_1plusx(1)")
compare(sf.log_1plusx_mx(1)              , -3.068528194400547e-01, "log_1plusx_mx(1)")
compare(sf.log_abs(1)                    ,  0.000000000000000e+00, "log_abs(1)")
compare(sf.poch(1,1)                     ,  1.000000000000000e+00, "poch(1,1)")
compare(sf.pochrel(1,1)                  ,  0.000000000000000e+00, "pochrel(1,1)")
compare(sf.pow_int(1,1)                  ,  1.000000000000000e+00, "pow_int(1,1)")
compare(sf.psi(1)                        , -5.772156649015328e-01, "psi(1)")
compare(sf.psi_1(1)                      ,  1.644934066848226e+00, "psi_1(1)")
compare(sf.psi_1piy(1)                   ,  9.465032062247691e-02, "psi_1piy(1)")
compare(sf.psi_n(1,1)                    ,  1.644934066848226e+00, "psi_n(1,1)")
compare(sf.synchrotron1(1)               ,  6.514228153553652e-01, "synchrotron1(1)")
compare(sf.synchrotron2(1)               ,  4.944750621042067e-01, "synchrotron2(1)")
compare(sf.taylorcoeff(1,1)              ,  1.000000000000000e+00, "taylorcoeff(1,1)")
compare(sf.transport(2,1)                ,  9.730325613551701e-01, "transport(2,1)")
compare(sf.zeta(0.9)                     , -9.430114019402254e+00, "zeta(0.9)")
compare(sf.zetam1(0.9)                   , -1.043011401940225e+01, "zetam1(0.9)")
compare(sf.hzeta(2,0.9)                  ,  1.922539959477204e+00, "hzeta(2,0.9)")

-- TODO: 
-- {sf.coulomb_wave_FG(1, 1, 1,1)}
-- sf.hydrogenicR(1,1,1,1)
-- sf.hydrogenicR_1(1,1)
--
-- sf.ellint_Ecomp(1)
-- sf.ellint_Kcomp(1)
-- {sf.elljac(1,1)}
-- {sf.lngammac(1+1i)}
-- sf.gegenpoly(1,1,1)
-- sf.hyperg2F0(1,1,1)
-- sf.hyperg2F1(1,1,1,1)
-- sf.hyperg2F1_renorm(1,1,1,1)
-- sf.hyperg2F1conj(1+1i, 1,1)
-- sf.hyperg2F1conj_renorm(1+1i, 1,1)
-- sf.legendreQ(1,1)
