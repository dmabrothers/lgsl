-- This is a (generated) test script for all the methods in the special functions module.

local sf = require("lgsl.sf")
local complex = require("lgsl.complex")
local gsl = require("lgsl.gsl")
local sprintf = function(...) return io.write(string.format(...)) end
local sqrt = math.sqrt
local eps = 1e-12

local function compare(val, ref, name)
  local inc = 0
  if val==0 or ref==0 then
    inc = 1
  end
  if gsl.gsl_fcmp(val+inc,ref+inc,eps)==0 then
    sprintf("Pass %-30s: % .15f\n",name, ref,"\n")
  else
    sprintf("Fail %-30s: % .15f ~= % .15f\n",name, val, ref)
  end
end

compare(sf.Chi(1)                        ,  0.837866940980208, "Chi(1)")
compare(sf.Ci(1)                         ,  0.337403922900968, "Ci(1)")
compare(sf.Shi(1)                        ,  1.057250875375728, "Shi(1)")
compare(sf.Si(1)                         ,  0.946083070367183, "Si(1)")
compare(sf.airyAi(1)                     ,  0.135292416312881, "airyAi(1)")
compare(sf.airyAi_deriv(1)               , -0.159147441296793, "airyAi_deriv(1)")
compare(sf.airyAi_deriv_scaled(1)        , -0.309976888960515, "airyAi_deriv_scaled(1)")
compare(sf.airyAi_scaled(1)              ,  0.263513644749140, "airyAi_scaled(1)")
compare(sf.airyAi_zero(1)                , -2.338107410459767, "airyAi_zero(1)")
compare(sf.airyAi_deriv_zero(1)          , -1.018792971647471, "airyAi_deriv_zero(1)")
compare(sf.airyBi(1)                     ,  1.207423594952871, "airyBi(1)")
compare(sf.airyBi_deriv(1)               ,  0.932435933392776, "airyBi_deriv(1)")
compare(sf.airyBi_deriv_scaled(1)        ,  0.478728570604985, "airyBi_deriv_scaled(1)")
compare(sf.airyBi_scaled(1)              ,  0.619911943572679, "airyBi_scaled(1)")
compare(sf.airyBi_zero(1)                , -1.173713222709128, "airyBi_zero(1)")
compare(sf.airyBi_deriv_zero(1)          , -2.294439682614123, "airyBi_deriv_zero(1)")
compare(sf.atanint(1)                    ,  0.915965594177219, "atanint(1)")
compare(sf.besselI(1,1)                  ,  0.565159103992485, "besselI(1,1)")
compare(sf.besselI_scaled(1,1)           ,  0.207910415349708, "besselI_scaled(1,1)")
compare(sf.besselInu(1,1)                ,  0.565159103992485, "besselInu(1,1)")
compare(sf.besselInu_scaled(1,1)         ,  0.207910415349708, "besselInu_scaled(1,1)")
compare(sf.besselJ(1,1)                  ,  0.440050585744933, "besselJ(1,1)")
compare(sf.besselJnu(1,1)                ,  0.440050585744934, "besselJnu(1,1)")
compare(sf.besselJ_zero(1,1)             ,  3.831705970207513, "besselJ_zero(1,1)")
compare(sf.besselK(1,1)                  ,  0.601907230197235, "besselK(1,1)")
compare(sf.besselK_scaled(1,1)           ,  1.636153486263258, "besselK_scaled(1,1)")
compare(sf.besselKnu(1,1)                ,  0.601907230197235, "besselKnu(1,1)")
compare(sf.besselKnu_scaled(1,1)         ,  1.636153486263258, "besselKnu_scaled(1,1)")
compare(sf.besselY(1,1)                  , -0.781212821300289, "besselY(1,1)")
compare(sf.besselYnu(1,1)                , -0.781212821300289, "besselYnu(1,1)")
compare(sf.besseli_scaled(1,1)           ,  0.135335283236613, "besseli_scaled(1,1)")
compare(sf.besselj(1,1)                  ,  0.301168678939757, "besselj(1,1)")
compare(sf.besselk_scaled(1,1)           ,  3.141592653589793, "besselk_scaled(1,1)")
compare(sf.bessellnKnu(1,1)              , -0.507651948210752, "bessellnKnu(1,1)")
compare(sf.bessely(1,1)                  , -1.381773290676036, "bessely(1,1)")
compare(sf.beta(1,1)                     ,  1.000000000000000, "beta(1,1)")
compare(sf.beta_inc(1,1,1)               ,  1.000000000000000, "beta_inc(1,1,1)")
compare(sf.choose(1,1)                   ,  1.000000000000000, "choose(1,1)")
compare(sf.doublefact(1)                 ,  1.000000000000000, "doublefact(1)")
compare(sf.fact(1)                       ,  1.000000000000000, "fact(1)")
compare(sf.clausen(1)                    ,  1.013959132360768, "clausen(1)")
compare(sf.conicalP(1,1,1)               ,  0.000000000000000, "conicalP(1,1,1)")
compare(sf.conicalPcylreg(1,1,1)         ,  0.000000000000000, "conicalPcylreg(1,1,1)")
compare(sf.conicalPsphreg(1,1,1)         ,  0.000000000000000, "conicalPsphreg(1,1,1)")
compare(sf.coulomb_CL(1,1)               ,  0.051110862831842, "coulomb_CL(1,1)")
compare(sf.coupling_3j(2,3,3,0,1,-1)     , -0.129099444873581, "coupling_3j(2,3,3,0,1,-1)")
compare(sf.coupling_6j(1,1,1,1,1,1)      ,  0.000000000000000, "coupling_6j(1,1,1,1,1,1)")
compare(sf.coupling_6j(2,2,2,2,2,2)      ,  0.166666666666667, "coupling_6j(2,2,2,2,2,2)")
compare(sf.coupling_9j(1,1,1,1,1,1,1,1,1),  0.000000000000000, "coupling_9j(1,1,1,1,1,1,1,1,1)")
compare(sf.coupling_9j(6,8,2,6,6,6,4,6,8), -0.005953880481553, "coupling_9j(6,8,2,6,6,6,4,6,8)")
compare(sf.dawson(1)                     ,  0.538079506912768, "dawson(1)")
compare(sf.debye(1,1)                    ,  0.777504634112248, "debye(1,1)")
compare(sf.dilog(1)                      ,  1.644934066848226, "dilog(1)")
compare(complex.real(sf.cdilog(1+1i))    ,  0.616850275068085, "Re(cdilog(1+1i))")
compare(complex.imag(sf.cdilog(1+1i))    ,  1.460362116753119, "Im(cdilog(1+1i))")
compare(sf.ellint_D(1,1,1)               ,  0.384720186075621, "ellint_D(1,1,1)")
compare(sf.ellint_E(1,1)                 ,  0.841470984807896, "ellint_E(1,1)")
compare(sf.ellint_F(1,1)                 ,  1.226191170883517, "ellint_F(1,1)")
compare(sf.ellint_P(1,1,1)               ,  0.962856407616018, "ellint_P(1,1,1)")
compare(sf.ellint_RC(1,1)                ,  1.000000000000000, "ellint_RC(1,1)")
compare(sf.ellint_RD(1,1,1)              ,  1.000000000000000, "ellint_RD(1,1,1)")
compare(sf.ellint_RF(1,1,1)              ,  1.000000000000000, "ellint_RF(1,1,1)")
compare(sf.ellint_RJ(1,1,1,1)            ,  1.000000000000000, "ellint_RJ(1,1,1,1)")
compare(sf.erf(1)                        ,  0.842700792949715, "erf(1)")
compare(sf.erf_Q(1)                      ,  0.158655253931457, "erf_Q(1)")
compare(sf.erf_Z(1)                      ,  0.241970724519143, "erf_Z(1)")
compare(sf.erfc(1)                       ,  0.157299207050285, "erfc(1)")
compare(sf.log_erfc(1)                   , -1.849605509933248, "log_erfc(1)")
compare(sf.eta(1)                        ,  0.693147180559945, "eta(1)")
compare(sf.exp(1)                        ,  2.718281828459045, "exp(1)")
compare(sf.exp_err(1,1)                  ,  2.718281828459045, "exp_err(1,1)")
compare(sf.exp_mult(1,1)                 ,  2.718281828459045, "exp_mult(1,1)")
compare(sf.exp_mult_err(1,1,1,1)         ,  2.718281828459045, "exp_mult_err(1,1,1,1)")
compare(sf.expint3(1)                    ,  0.807511182139672, "expint3(1)")
compare(sf.expint_Ei(1)                  ,  1.895117816355937, "expint_Ei(1)")
compare(sf.expint_E(1,1)                 ,  0.219383934395520, "expint_E(1,1)")
compare(sf.expm1(1)                      ,  1.718281828459045, "expm1(1)")
compare(sf.exprel(1)                     ,  1.718281828459045, "exprel(1)")
compare(sf.exprel_2(1)                   ,  1.436563656918090, "exprel_2(1)")
compare(sf.exprel_n(1,1)                 ,  1.718281828459045, "exprel_n(1,1)")
compare(sf.fermi_dirac(1,1)              ,  1.806286070444775, "fermi_dirac(1,1)")
compare(sf.fermi_dirac_inc(1,1)          ,  0.693147180559945, "fermi_dirac_inc(1,1)")
compare(sf.gamma(1)                      ,  1.000000000000000, "gamma(1)")
compare(sf.gamma_inc(1,1)                ,  0.367879441171442, "gamma_inc(1,1)")
compare(sf.gamma_inc_P(1,1)              ,  0.632120558828558, "gamma_inc_P(1,1)")
compare(sf.gamma_inc_Q(1,1)              ,  0.367879441171442, "gamma_inc_Q(1,1)")
compare(sf.gammainv(1)                   ,  1.000000000000000, "gammainv(1)")
compare(sf.gammastar(1)                  ,  1.084437551419227, "gammastar(1)")
compare(sf.hyperg0F1(1,1)                ,  2.279585302336067, "hyperg0F1(1,1)")
compare(sf.hyperg1F1(1,1,1)              ,  2.718281828459045, "hyperg1F1(1,1,1)")
compare(sf.hypergU(1,1,1)                ,  0.596347362323194, "hypergU(1,1,1)")
compare(sf.laguerre(1,1,1)               ,  1.000000000000000, "laguerre(1,1,1)")
compare(sf.lambertW0(1)                  ,  0.567143290409784, "lambertW0(1)")
compare(sf.lambertWm1(1)                 ,  0.567143290409784, "lambertWm1(1)")
compare(sf.legendreH3d(1,1,1)            ,  0.339701399479935, "legendreH3d(1,1,1)")
compare(sf.legendreP(1,1)                ,  1.000000000000000, "legendreP(1,1)")
compare(sf.legendrePlm(1,1,1)            , -0.000000000000000, "legendrePlm(1,1,1)")
compare(sf.legendresphPlm(1,1,1)         ,  0.000000000000000, "legendresphPlm(1,1,1)")
compare(sf.lnbeta(1,1)                   , -0.000000000000000, "lnbeta(1,1)")
compare(sf.lnchoose(1,1)                 ,  0.000000000000000, "lnchoose(1,1)")
compare(sf.lndoublefact(1)               ,  0.000000000000000, "lndoublefact(1)")
compare(sf.lnfact(1)                     ,  0.000000000000000, "lnfact(1)")
compare(sf.lngamma(1)                    , -0.000000000000000, "lngamma(1)")
compare(sf.lnpoch(1,1)                   , -0.000000000000000, "lnpoch(1,1)")
compare(sf.log(1)                        ,  0.000000000000000, "log(1)")
compare(sf.log_1plusx(1)                 ,  0.693147180559945, "log_1plusx(1)")
compare(sf.log_1plusx_mx(1)              , -0.306852819440055, "log_1plusx_mx(1)")
compare(sf.log_abs(1)                    ,  0.000000000000000, "log_abs(1)")
compare(sf.poch(1,1)                     ,  1.000000000000000, "poch(1,1)")
compare(sf.pochrel(1,1)                  ,  0.000000000000000, "pochrel(1,1)")
compare(sf.pow_int(1,1)                  ,  1.000000000000000, "pow_int(1,1)")
compare(sf.psi(1)                        , -0.577215664901533, "psi(1)")
compare(sf.psi_1(1)                      ,  1.644934066848226, "psi_1(1)")
compare(sf.psi_1piy(1)                   ,  0.094650320622477, "psi_1piy(1)")
compare(sf.psi_n(1,1)                    ,  1.644934066848226, "psi_n(1,1)")
compare(sf.synchrotron1(1)               ,  0.651422815355365, "synchrotron1(1)")
compare(sf.synchrotron2(1)               ,  0.494475062104207, "synchrotron2(1)")
compare(sf.taylorcoeff(1,1)              ,  1.000000000000000, "taylorcoeff(1,1)")
compare(sf.transport(2,1)                ,  0.973032561355170, "transport(2,1)")
compare(sf.zeta(0.9)                     , -9.430114019402254, "zeta(0.9)")
compare(sf.zetam1(0.9)                   , -10.430114019402254, "zetam1(0.9)")
compare(sf.hzeta(2,0.9)                  ,  1.922539959477204, "hzeta(2,0.9)")

-- TODO: 
-- {sf.coulomb_wave_FG(1, 1, 1,1)}
-- sf.hydrogenicR(1,1,1,1)
-- sf.hydrogenicR_1(1,1)
--
-- sf.ellint_Ecomp(1)
-- sf.ellint_Kcomp(1)
-- {sf.elljac(1,1)}
-- {sf.lngammac(1+1i)}
-- sf.gegenpoly(1,1,1)
-- sf.hyperg2F0(1,1,1)
-- sf.hyperg2F1(1,1,1,1)
-- sf.hyperg2F1_renorm(1,1,1,1)
-- sf.hyperg2F1conj(1+1i, 1,1)
-- sf.hyperg2F1conj_renorm(1+1i, 1,1)
-- sf.legendreQ(1,1)
